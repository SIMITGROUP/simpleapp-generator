<script lang="ts" setup>
import Dialog from 'primevue/dialog';
import {ref} from 'vue'
import {MenuData} from '~/types'
const visible = ref(false)

// const emit = defineEmits(['select'])
const selectMenu = (menuname:{name:string,children:any}) =>{
  goTo(menuname.name)
  visible.value=false  
}


const m =  getMenustFromPageMeta()
const treemenu:any[] = []


getMenustFromPageMeta().reduce((r, item) => {
    item.split('/').reduce((o, name) => {
        var temp = (o.children = o.children || []).find(q => q.name === name);
        if (!temp) o.children.push(temp = { name });
        return temp;
    }, r);
    return r;
}, { children: treemenu })


</script>
<template>
  
    <button class="text-center border-none  cursor-pointer pi pi-bars dark:text-white" v-if="getCurrentXorg()" @click="visible=true">     
      <Dialog v-model:visible="visible" modal :header="t('pickDocument')" :pt="{dialog:{ class:' bg-primary-800 ' }}">
      <div class="">
          <div v-for="m in treemenu" class="m-4">
            <h3>{{ t(m.name) }}</h3>
            <div class="grid md:grid-cols-2 lg:grid-cols-6 gap-4">
              <ButtonPrimary v-for="submenu in m.children" class="border rounded-lg p-2" @click="selectMenu(submenu)">              
                {{ t(submenu.name) }}
              </ButtonPrimary>
            </div>
            
          </div>
          
        </div>
    </Dialog>           
    </button>  
</template>

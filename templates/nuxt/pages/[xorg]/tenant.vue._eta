<template>
  <div class="grid grid-cols-6 gap-4">
    <div v-for="(item,index) in tenantList" :key="index" 
      class="col flex flex-col border rounded shadow p-2 cursor-pointer" @click="editTenant(item._id)">
      <TextTitle>{{item.tenantName}}</TextTitle>
      <TextSubsubtitle >{{item.owner.label}}</TextSubsubtitle>
      <RendererBoolean v-model="item.active"></RendererBoolean>
    </div>

    <Drawer v-model:visible="visible" header="Tenant" position="full">
        <FormTenant :_id="recordId" @after="search"></FormTenant>
    </Drawer>
  </div>
</template>
<script setup lang="ts">
/**
 * This file was automatically generated by simpleapp generator.
 * last change 2023-09-09
 * author: Ks Tan
 */
// import RendererBoolean from "~/components/renderer/RendererBoolean.vue";
// import TextPrimary from "~/components/text/TextPrimary.vue";
import Drawer from 'primevue/drawer';

import TextSubsubtitle from "~/components/text/TextSubsubtitle.vue";
import TextTitle from "~/components/text/TextTitle.vue";
import { Tenant } from "~/simpleapp/generate/openapi";

const { $TenantDoc, $listen } = useNuxtApp();
const doc = $TenantDoc();
const docdata = doc.getReactiveData();
const id = ref('')
const visible = ref(false)
definePageMeta({
  menuPath: "systemadmin/list/tenant",
});
const tenantList = ref<Tenant[]>([]) 
const recordId = ref('')
const search = async ()=>{
  tenantList.value =await doc.search({
    fields:['_id','tenantName','owner','active','clientSetting']
  })
}

const editTenant = (id?:string)=>{
  visible.value=true
  recordId.value=id??''
}

onMounted(async()=>{
  await search()
})

</script>

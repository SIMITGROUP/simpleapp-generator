<template>
  <div class="grid grid-cols-6 gap-4">
    <div v-for="(item,index) in recordList" :key="index" 
      class="col flex flex-col border rounded shadow p-2 cursor-pointer" @click="editRecord(item._id)">
      <TextTitle>{{item.fullName}}</TextTitle>
      <TextSubsubtitle >{{item.email}}</TextSubsubtitle>
      <RendererBoolean v-model="item.active"></RendererBoolean>
    </div>

    <Drawer v-model:visible="visible" header="User" position="full">
        <FormUser :_id="recordId" @after="search"></FormUser>
    </Drawer>
  </div>
</template>
<script setup lang="ts">
/**
 * This file was automatically generated by simpleapp generator.
 * last change 2023-09-09
 * author: Ks Tan
 */
// import RendererBoolean from "~/components/renderer/RendererBoolean.vue";
// import TextPrimary from "~/components/text/TextPrimary.vue";
import Drawer from 'primevue/drawer';

import TextSubsubtitle from "~/components/text/TextSubsubtitle.vue";
import TextTitle from "~/components/text/TextTitle.vue";
import { User } from "~/simpleapp/generate/openapi";

const { $UserDoc, $listen } = useNuxtApp();
const doc = $UserDoc();
const docdata = doc.getReactiveData();
const id = ref('')
const visible = ref(false)
definePageMeta({
  menuPath: "systemconfig/setting/user",
});
const recordList = ref<User[]>([]) 
const recordId = ref('')
const search = async ()=>{
  recordList.value =await doc.search({
    fields:['_id','fullName','email','active']
  })
}

const editRecord = (id?:string)=>{
  visible.value=true
  recordId.value=id??''
}

onMounted(async()=>{
  await search()
})

</script>
